<!doctype html>
<html xmlns:th="http://www.thymeleaf.org">

<head th:replace="fragments :: html_head(pageTitle='Test Contact')"/>

<body>

<!-- container section start -->
<section id="container" class="">
    <header th:replace="fragments :: bar"></header>
    <aside th:replace="fragments :: menu"></aside>
    <!--main content start-->
    <section id="main-content">
        <section class="wrapper">
            <div class="row">
                <div class="col-lg-12">
                    <h3 class="page-header" style="font-family: arial;">
                        <i class="fa fa-gift"></i> Danh sách liên hệ
                    </h3>
                    <ol class="breadcrumb" style="font-family: arial;">
                        <li><a th:href="@{/admin}">Trang chủ</a></li>
                        <li>Liên hệ</li>
                    </ol>
                </div>
            </div>
            <!-- page start-->
            <div class="row">
                <div class="col-lg-12">
                    <input type="text" id="searchByName" name="searchByName" placeholder="Search for name ...">
                    <form id="formSubmit" action="#" method="get">
                        <section class="panel">
                            <table id="table" class="table table-striped table-advance table-hover"
                                   style="font-family: arial;">
                                <thead>
                                <th style="text-align: center;">ID</th>
                                <th style="text-align: center;">Name</th>
                                <th style="text-align: center;">Email</th>
                                <th style="text-align: center;">Phone</th>
                                <th style="text-align: center;">Address</th>
                                <th colspan="2" style="text-align: center;">Action</th>
                                </thead>
                                <tbody class="row-data">
                                </tbody>
                            </table>
                            <br>
                        </section>
                        <ul class="pagination" id="pagination"></ul>
                        <input type="hidden" id="page" name="page" value="1" />
                    </form>
                </div>
            </div>
            <!-- page end-->
        </section>
    </section>
    <!--main content end-->

</section>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="/paging/jquery.twbsPagination.js"></script>
<script src="/paging/jquery.twbsPagination.min.js"></script>
<script type="text/javascript">
    $(document).ready(function () {

        ajaxGet(1);

        function ajaxGet(pageNo) {
            $.ajax({
                type: "GET",
                contentType: "application/json",
                url: "http://localhost:8080/admin/contact/api-getall/" + pageNo,
                success: function (result) {
                    $('#page').val(pageNo);

                    $('.row-data').html('');
                    $.each(result.content, function (index, contact) {
                        let row = `<tr style="text-align: center;">
                                       <td>${contact.id}</td>
                                       <td>${contact.name}</td>
                                       <td>${contact.email}</td>
                                       <td>${contact.phone}</td>
                                       <td>${contact.address}</td>
                                       <td>
                                           <div class="btn-group">
                                               <a class="btn btn-primary" th:href="@{'/admin/contact/' +${contact.id}}">Update</a>
                                               <a class="btn btn-danger" onclick="if(!confirm('Bạn có chắc muốn xóa liên hệ?')) return false;" th:href="@{'/admin/contact/delete/' +${contact.id}}">Delete</a>
                                           </div>
                                       </td>
                                   </tr>`;
                        $('.row-data').append(row);
                    });

                    pagination(result.totalPages, pageNo, ajaxGet);

                },
                error: function (e) {
                    alert("Error: ", e);
                    console.log("Error", e);
                }
            });
        };

        function pagination(totalPages, currentPage, ajaxGet) {
            $('#pagination').twbsPagination({
                totalPages: totalPages,
                visiblePages: 3,
                startPage: currentPage,
                onPageClick: function (event, page) {
                    var now = $('#page').val();
                    if (now !== page) {
                        ajaxGet(page);
                    }
                }
            });
        };
    });



    // $(document).on('keyup', '#searchById', function(event) {
    //     var searchByName = $('#searchByName').val();
    //     ajaxGetName(1, searchByName);
    // });
    //
    // function ajaxGetName(pageNo, searchByName) {
    //     // var searchByName = $('#searchByName').val();
    //     console.log(searchByName);
    //     if (searchByName.trim() != '') {
    //         $.ajax({
    //             type: "GET",
    //             contentType: "application/json",
    //             url: "http://localhost:8080/admin/contact/api-getname/" + pageNo + "/" + searchByName,
    //             success: function (result) {
    //                 $('.row-data').html('');
    //                 $.each(result.content, function (index, contact) {
    //                     let row = `<tr style="text-align: center;">
    //                                    <td>${contact.id}</td>
    //                                    <td>${contact.name}</td>
    //                                    <td>${contact.email}</td>
    //                                    <td>${contact.phone}</td>
    //                                    <td>${contact.address}</td>
    //                                    <td>
    //                                        <div class="btn-group">
    //                                            <a class="btn btn-primary" th:href="@{'/admin/contact/' +${contact.id}}">Update</a>
    //                                            <a class="btn btn-danger" onclick="if(!confirm('Bạn có chắc muốn xóa liên hệ?')) return false;" th:href="@{'/admin/contact/delete/' +${contact.id}}">Delete</a>
    //                                        </div>
    //                                    </td>
    //                                </tr>`;
    //                     $('.row-data').append(row);
    //                 });
    //
    //                 paginationName(result.totalPages, pageNo, searchByName, ajaxGet);
    //
    //             },
    //             error: function (e) {
    //                 alert("Error: ", e);
    //                 console.log("Error", e);
    //             }
    //         });
    //     }
    // }
    //
    // function paginationName(totalPages, currentPage, searchName, ajaxGetName) {
    //     $('#pagination').twbsPagination({
    //         totalPages: totalPages,
    //         visiblePages: 3,
    //         startPage: currentPage,
    //         onPageClick: function (event, page) {
    //             if (currentPage !== page) {
    //                 ajaxGetName(page, searchName);
    //             }
    //         }
    //     });
    // };

</script>

</body>
</html>